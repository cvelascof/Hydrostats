
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="X-UA-Compatible" content="IE=Edge" />
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>hydrostats.metrics &#8212; hydrostats 0.65 documentation</title>
    <link rel="stylesheet" href="../../_static/pyramid.css" type="text/css" />
    <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
    <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
    <script type="text/javascript" src="../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../_static/doctools.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Neuton&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Nobile:regular,italic,bold,bolditalic&amp;subset=latin" type="text/css" media="screen" charset="utf-8" />
<!--[if lte IE 6]>
<link rel="stylesheet" href="../../_static/ie6.css" type="text/css" media="screen" charset="utf-8" />
<![endif]-->

  </head><body>

    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             accesskey="I">index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">hydrostats 0.65 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" accesskey="U">Module code</a> &#187;</li> 
      </ul>
    </div>  

    <div class="document">
      <div class="documentwrapper">
        <div class="bodywrapper">
          <div class="body" role="main">
            
  <h1>Source code for hydrostats.metrics</h1><div class="highlight"><pre>
<span></span><span class="c1"># python 3.6</span>
<span class="c1"># -*- coding: utf-8 -*-</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="sd">The metrics module contains all of the metrics included in hydrostats. Each metric is contained in</span>
<span class="sd">function, and every metric has the ability to treat missing values as well as remove zero and</span>
<span class="sd">negative values from the timeseries data.</span>

<span class="sd">&quot;&quot;&quot;</span>
<span class="kn">from</span> <span class="nn">__future__</span> <span class="k">import</span> <span class="n">division</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
<span class="kn">from</span> <span class="nn">numba</span> <span class="k">import</span> <span class="n">njit</span><span class="p">,</span> <span class="n">prange</span>
<span class="kn">from</span> <span class="nn">scipy.stats</span> <span class="k">import</span> <span class="n">gmean</span><span class="p">,</span> <span class="n">rankdata</span>
<span class="kn">import</span> <span class="nn">warnings</span>

<span class="n">__all__</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;me&#39;</span><span class="p">,</span> <span class="s1">&#39;mae&#39;</span><span class="p">,</span> <span class="s1">&#39;mse&#39;</span><span class="p">,</span> <span class="s1">&#39;ed&#39;</span><span class="p">,</span> <span class="s1">&#39;ned&#39;</span><span class="p">,</span> <span class="s1">&#39;rmse&#39;</span><span class="p">,</span> <span class="s1">&#39;rmsle&#39;</span><span class="p">,</span> <span class="s1">&#39;mase&#39;</span><span class="p">,</span> <span class="s1">&#39;r_squared&#39;</span><span class="p">,</span> <span class="s1">&#39;acc&#39;</span><span class="p">,</span> <span class="s1">&#39;mape&#39;</span><span class="p">,</span>
           <span class="s1">&#39;mapd&#39;</span><span class="p">,</span> <span class="s1">&#39;smape1&#39;</span><span class="p">,</span> <span class="s1">&#39;smape2&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;d1&#39;</span><span class="p">,</span> <span class="s1">&#39;dr&#39;</span><span class="p">,</span> <span class="s1">&#39;drel&#39;</span><span class="p">,</span> <span class="s1">&#39;dmod&#39;</span><span class="p">,</span> <span class="s1">&#39;watt_m&#39;</span><span class="p">,</span> <span class="s1">&#39;mb_r&#39;</span><span class="p">,</span> <span class="s1">&#39;nse&#39;</span><span class="p">,</span>
           <span class="s1">&#39;nse_mod&#39;</span><span class="p">,</span> <span class="s1">&#39;nse_rel&#39;</span><span class="p">,</span> <span class="s1">&#39;lm_index&#39;</span><span class="p">,</span> <span class="s1">&#39;sa&#39;</span><span class="p">,</span> <span class="s1">&#39;sc&#39;</span><span class="p">,</span> <span class="s1">&#39;sid&#39;</span><span class="p">,</span> <span class="s1">&#39;sga&#39;</span><span class="p">,</span> <span class="s1">&#39;h1_mhe&#39;</span><span class="p">,</span> <span class="s1">&#39;h1_ahe&#39;</span><span class="p">,</span>
           <span class="s1">&#39;h1_rmshe&#39;</span><span class="p">,</span> <span class="s1">&#39;h2_mhe&#39;</span><span class="p">,</span> <span class="s1">&#39;h2_ahe&#39;</span><span class="p">,</span> <span class="s1">&#39;h2_rmshe&#39;</span><span class="p">,</span> <span class="s1">&#39;h3_mhe&#39;</span><span class="p">,</span> <span class="s1">&#39;h3_ahe&#39;</span><span class="p">,</span> <span class="s1">&#39;h3_rmshe&#39;</span><span class="p">,</span> <span class="s1">&#39;h4_mhe&#39;</span><span class="p">,</span>
           <span class="s1">&#39;h4_ahe&#39;</span><span class="p">,</span> <span class="s1">&#39;h4_rmshe&#39;</span><span class="p">,</span> <span class="s1">&#39;h5_mhe&#39;</span><span class="p">,</span> <span class="s1">&#39;h5_ahe&#39;</span><span class="p">,</span> <span class="s1">&#39;h5_rmshe&#39;</span><span class="p">,</span> <span class="s1">&#39;h6_mhe&#39;</span><span class="p">,</span> <span class="s1">&#39;h6_ahe&#39;</span><span class="p">,</span> <span class="s1">&#39;h6_rmshe&#39;</span><span class="p">,</span>
           <span class="s1">&#39;h7_mhe&#39;</span><span class="p">,</span> <span class="s1">&#39;h7_ahe&#39;</span><span class="p">,</span> <span class="s1">&#39;h7_rmshe&#39;</span><span class="p">,</span> <span class="s1">&#39;h8_mhe&#39;</span><span class="p">,</span> <span class="s1">&#39;h8_ahe&#39;</span><span class="p">,</span> <span class="s1">&#39;h8_rmshe&#39;</span><span class="p">,</span> <span class="s1">&#39;h10_mhe&#39;</span><span class="p">,</span> <span class="s1">&#39;h10_ahe&#39;</span><span class="p">,</span>
           <span class="s1">&#39;h10_rmshe&#39;</span><span class="p">,</span> <span class="s1">&#39;g_mean_diff&#39;</span><span class="p">,</span> <span class="s1">&#39;mean_var&#39;</span><span class="p">,</span> <span class="s1">&#39;mle&#39;</span><span class="p">,</span> <span class="s1">&#39;male&#39;</span><span class="p">,</span> <span class="s1">&#39;msle&#39;</span><span class="p">,</span> <span class="s1">&#39;nrmse_range&#39;</span><span class="p">,</span>
           <span class="s1">&#39;nrmse_mean&#39;</span><span class="p">,</span> <span class="s1">&#39;nrmse_iqr&#39;</span><span class="p">,</span> <span class="s1">&#39;maape&#39;</span><span class="p">,</span> <span class="s1">&#39;d1_p&#39;</span><span class="p">,</span> <span class="s1">&#39;ve&#39;</span><span class="p">,</span> <span class="s1">&#39;pearson_r&#39;</span><span class="p">,</span> <span class="s1">&#39;spearman_r&#39;</span><span class="p">,</span> <span class="s1">&#39;kge_2009&#39;</span><span class="p">,</span>
           <span class="s1">&#39;kge_2012&#39;</span><span class="p">]</span>


<span class="c1">####################################################################################################</span>
<span class="c1">#                            General and Hydrological Error Metrics                                #</span>
<span class="c1">####################################################################################################</span>


<div class="viewcode-block" id="me"><a class="viewcode-back" href="../../api/hydrostats.metrics.me.html#hydrostats.metrics.me">[docs]</a><span class="k">def</span> <span class="nf">me</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
       <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the mean error of the simulated and observed data.</span>

<span class="sd">    **Range:** -inf &lt; MAE &lt; inf, data units, closer to zero is better, indicates bias.</span>

<span class="sd">    **Notes:** The mean error (ME) measures the difference between the simulated data and the</span>
<span class="sd">    observed data. For the mean error, a smaller number indicates a better fit to the original</span>
<span class="sd">    data. Note that if the error is in the form of random noise, the mean error will be very small,</span>
<span class="sd">    which can skew the accuracy of this metric. ME is cumulative and will be small even if there</span>
<span class="sd">    are large positive and negative errors that balance.</span>

<span class="sd">    *x = observed data and y = simulated data*</span>

<span class="sd">    ![Mean Error](https://github.com/waderoberts123/Hydrostats/blob/master/docs/pictures/ME.png?raw=true)</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array:  *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **Example**</span>

<span class="sd">    ```python</span>
<span class="sd">    import hydrostats as hs</span>
<span class="sd">    import numpy as np</span>

<span class="sd">    sim = np.arange(10)</span>
<span class="sd">    obs = np.random.rand(10)</span>

<span class="sd">    hs.me(sim, obs)</span>
<span class="sd">    ```</span>

<span class="sd">    **References**</span>

<span class="sd">    - Fisher, R.A., 1920. A Mathematical Examination of the Methods of Determining the Accuracy of</span>
<span class="sd">      an Observation by the Mean Error, and by the Mean Square Error. Monthly Notices of the Royal</span>
<span class="sd">      Astronomical Society 80 758 - 770.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking data to make sure it will work and the arrays are correct</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>

    <span class="c1"># Treating missing values</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span>
                                                    <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
                                                    <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
                                                    <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
                                                    <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span></div>


<div class="viewcode-block" id="mae"><a class="viewcode-back" href="../../api/hydrostats.metrics.mae.html#hydrostats.metrics.mae">[docs]</a><span class="k">def</span> <span class="nf">mae</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the mean absolute error of the simulated and observed data.</span>

<span class="sd">    **Notes:** The ME measures the absolute difference between the simulated data and the observed</span>
<span class="sd">    data. For the mean abolute error, a smaller number indicates a better fit to the original data.</span>
<span class="sd">    Also note that random errors do not cancel. Also referred to as an L1-norm.</span>

<span class="sd">    **Range:** 0 ≤ MAE &lt; inf, data units, smaller is better, does not indicate bias.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References**</span>

<span class="sd">    - Willmott, Cort J., and Kenji Matsuura. “Advantages of the Mean Absolute Error (MAE) over the</span>
<span class="sd">      Root Mean Square Error (RMSE) in Assessing Average Model Performance.” Climate Research 30,</span>
<span class="sd">      no. 1 (2005): 79–82.</span>
<span class="sd">    - Willmott, Cort J., and Kenji Matsuura. “On the Use of Dimensioned Measures of Error to</span>
<span class="sd">      Evaluate the Performance of Spatial Interpolators.” International Journal of Geographical</span>
<span class="sd">      Information Science 20, no. 1 (2006): 89–102.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">absolute</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">))</span></div>


<div class="viewcode-block" id="mse"><a class="viewcode-back" href="../../api/hydrostats.metrics.mse.html#hydrostats.metrics.mse">[docs]</a><span class="k">def</span> <span class="nf">mse</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the mean squared error of the simulated and observed data.</span>

<span class="sd">    **Range:** 0 ≤ MSE &lt; inf, data units squared, smaller is better, does not indicate bias.</span>

<span class="sd">    **Notes:** Random errors do not cancel, highlights larger errors, also referred to as a</span>
<span class="sd">    squared L2-norm.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References**</span>
<span class="sd">    - Wang, Zhou, and Alan C. Bovik. “Mean Squared Error: Love It or Leave It? A New Look at Signal</span>
<span class="sd">      Fidelity Measures.” IEEE Signal Processing Magazine 26, no. 1 (2009): 98–117.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span></div>


<div class="viewcode-block" id="mle"><a class="viewcode-back" href="../../api/hydrostats.metrics.mle.html#hydrostats.metrics.mle">[docs]</a><span class="k">def</span> <span class="nf">mle</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the mean log error of the simulated and observed data.</span>

<span class="sd">    **Range:** -inf &lt; MLE &lt; inf, data units, closer to zero is better, indicates bias.</span>

<span class="sd">    **Notes** Same as ME only use log ratios as the error term. Limits the impact of outliers, more</span>
<span class="sd">    evenly weights high and low data values.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References**</span>

<span class="sd">    - Törnqvist, Leo, Pentti Vartia, and Yrjö O. Vartia. “How Should Relative Changes Be Measured?”</span>
<span class="sd">      The American Statistician 39, no. 1 (1985): 43–46.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">sim_log</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
    <span class="n">obs_log</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">sim_log</span> <span class="o">-</span> <span class="n">obs_log</span><span class="p">)</span></div>


<div class="viewcode-block" id="male"><a class="viewcode-back" href="../../api/hydrostats.metrics.male.html#hydrostats.metrics.male">[docs]</a><span class="k">def</span> <span class="nf">male</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the mean absolute log error of the simulated and observed data.</span>

<span class="sd">    **Range:** 0 ≤ MALE &lt; inf, data units squared, smaller is better, does not indicate bias.</span>

<span class="sd">    **Notes** Same as MAE only use log ratios as the error term. Limits the impact of outliers,</span>
<span class="sd">    more evenly weights high and low flows.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References**</span>

<span class="sd">    - Törnqvist, Leo, Pentti Vartia, and Yrjö O. Vartia. “How Should Relative Changes Be Measured?”</span>
<span class="sd">      The American Statistician 39, no. 1 (1985): 43–46.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">sim_log</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
    <span class="n">obs_log</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">sim_log</span> <span class="o">-</span> <span class="n">obs_log</span><span class="p">))</span></div>


<div class="viewcode-block" id="msle"><a class="viewcode-back" href="../../api/hydrostats.metrics.msle.html#hydrostats.metrics.msle">[docs]</a><span class="k">def</span> <span class="nf">msle</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the mean squared log error of the simulated and observed data.</span>

<span class="sd">    **Range:** 0 ≤ MSLE &lt; inf, data units squared, smaller is better, does not indicate bias.</span>

<span class="sd">    **Notes** Same as the mean squared error (MSE) only use log ratios as the error term. Limits</span>
<span class="sd">    the impact of outliers, more evenly weights high and low values.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References**</span>

<span class="sd">    - Törnqvist, Leo, Pentti Vartia, and Yrjö O. Vartia. “How Should Relative Changes Be Measured?”</span>
<span class="sd">      The American Statistician 39, no. 1 (1985): 43–46.</span>
<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">sim_log</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
    <span class="n">obs_log</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">sim_log</span> <span class="o">-</span> <span class="n">obs_log</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span></div>


<span class="k">def</span> <span class="nf">mde</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the median error (MdE) between the simulated and observed data.</span>

<span class="sd">    **Range** -inf &lt; MdE &lt; inf, closer to zero is better.</span>
<span class="sd">    **Notes** This metric indicates bias. It is similar to the mean error (ME), only it takes the</span>
<span class="sd">    median rather than the mean. Median measures reduces the impact of outliers.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when</span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span>


<span class="k">def</span> <span class="nf">mdae</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the median absolute error (MdAE) between the simulated and observed data.</span>

<span class="sd">    **Range** 0 ≤ MdAE &lt; inf, closer to zero is better.</span>

<span class="sd">    **Notes** This metric does not indicates bias. Random errors (noise) do not cancel.</span>
<span class="sd">    It is similar to the mean absolute error (MAE), only it takes the median rather than</span>
<span class="sd">    the mean. Median measures reduces the impact of outliers.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when</span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">))</span>


<span class="k">def</span> <span class="nf">mdse</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the median squared error (MdSE) between the simulated and observed data.</span>

<span class="sd">    **Range** 0 ≤ MdSE &lt; inf, closer to zero is better.</span>

<span class="sd">    **Notes** This metric does not indicates bias. Random errors (noise) do not cancel.</span>
<span class="sd">    It is similar to the mean squared error (MSE), only it takes the median rather than</span>
<span class="sd">    the mean. Median measures reduces the impact of outliers.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when</span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">median</span><span class="p">((</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span><span class="o">**</span><span class="mi">2</span><span class="p">)</span>


<div class="viewcode-block" id="ed"><a class="viewcode-back" href="../../api/hydrostats.metrics.ed.html#hydrostats.metrics.ed">[docs]</a><span class="k">def</span> <span class="nf">ed</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
       <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the Euclidean distance between predicted and observed values in vector space.</span>

<span class="sd">    **Range** 0 ≤ ED &lt; inf, smaller is better.</span>
<span class="sd">    **Notes** This metric does not indicate bias. It is also sometimes referred to as the L2-norm.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References**</span>

<span class="sd">    - Kennard, M. J., Mackay, S. J., Pusey, B. J., Olden, J. D., &amp; Marsh, N. (2010). Quantifying</span>
<span class="sd">      uncertainty in estimation of hydrologic metrics for ecohydrological studies. River Research</span>
<span class="sd">      and Applications, 26(2), 137-156.</span>
<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">simulated_array</span><span class="p">)</span></div>


<div class="viewcode-block" id="ned"><a class="viewcode-back" href="../../api/hydrostats.metrics.ned.html#hydrostats.metrics.ned">[docs]</a><span class="k">def</span> <span class="nf">ned</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>
<span class="sd">    Compute the normalized Euclidian distance between the simulated and observed data in vector</span>
<span class="sd">    space.</span>

<span class="sd">    **Range** 0 ≤ NED &lt; inf, smaller is better.</span>
<span class="sd">    **Notes** This metric does not indicate bias. It is also sometimes referred to as the squared</span>
<span class="sd">    L2-norm.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Kennard, M. J., Mackay, S. J., Pusey, B. J., Olden, J. D., &amp; Marsh, N. (2010). Quantifying</span>
<span class="sd">      uncertainty in estimation of hydrologic metrics for ecohydrological studies. River Research</span>
<span class="sd">      and Applications, 26(2), 137-156.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">observed_array</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">simulated_array</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">a</span> <span class="o">-</span> <span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="rmse"><a class="viewcode-back" href="../../api/hydrostats.metrics.rmse.html#hydrostats.metrics.rmse">[docs]</a><span class="k">def</span> <span class="nf">rmse</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the root mean square error between the simulated and observed data.</span>

<span class="sd">    **Range** 0 ≤ RMSE &lt; inf, smaller is better.</span>
<span class="sd">    **Notes** Random errors do not cancel. This metric will highlights larger errors. It is also</span>
<span class="sd">    referred to as an L2-norm.</span>

<span class="sd">    Hyndman and Koehler, 2006; Willmott and Matsuura, 2005</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>
<span class="sd">    - Willmott, C.J., Matsuura, K., 2005. Advantages of the mean absolute error (MAE) over the</span>
<span class="sd">    root mean square error (RMSE) in assessing average model performance.</span>
<span class="sd">    Climate Research 30(1) 79-82.</span>
<span class="sd">    - Hyndman, R.J., Koehler, A.B., 2006. Another look at measures of forecast accuracy.</span>
<span class="sd">    International Journal of Forecasting 22(4) 679-688.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span></div>


<div class="viewcode-block" id="rmsle"><a class="viewcode-back" href="../../api/hydrostats.metrics.rmsle.html#hydrostats.metrics.rmsle">[docs]</a><span class="k">def</span> <span class="nf">rmsle</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the root mean square log error between the simulated and observed data.</span>

<span class="sd">    **Range:** 0 ≤ RMSLE &lt; inf. Smaller is better, and it does not indicate bias.</span>

<span class="sd">    **Notes:** Random errors do not cancel while using this metric. This metric also limits the</span>
<span class="sd">    impact of outliers by more evenly weighting high and low values. To calculate the log values,</span>
<span class="sd">    each value in the observed and simulated array is increased by one unit in order to avoid</span>
<span class="sd">    run-time errors and nan values (function np.log1p).</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Tornquist, L., Vartia, P., Vartia, Y.O., 1985. How Should Relative Changes be Measured?</span>
<span class="sd">    The American Statistician 43-46.</span>
<span class="sd">    - Willmott, C.J., Matsuura, K., 2005. Advantages of the mean absolute error (MAE) over the</span>
<span class="sd">    root mean square error (RMSE) in assessing average model performance.</span>
<span class="sd">    Climate Research 30(1) 79-82.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span>
                                                    <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
                                                    <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
                                                    <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">observed_array</span><span class="p">),</span> <span class="mi">2</span><span class="p">)))</span></div>


<div class="viewcode-block" id="nrmse_range"><a class="viewcode-back" href="../../api/hydrostats.metrics.nrmse_range.html#hydrostats.metrics.nrmse_range">[docs]</a><span class="k">def</span> <span class="nf">nrmse_range</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the range normalized root mean square error between the simulated and observed data.</span>

<span class="sd">    **Range:** 0 ≤ NRMSE &lt; inf.</span>

<span class="sd">    **Notes:** This metric is the RMSE normalized by the range of the observed time series (x).</span>
<span class="sd">    Normalizing allows comparison between data sets with different scales. The NRMSErange is the</span>
<span class="sd">    most sensitive to outliers of the three normalized rmse metrics.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Pontius, R.G., Thontteh, O., Chen, H., 2008. Components of information for multiple</span>
<span class="sd">    resolution comparison between maps that share a real variable. Environmental and Ecological</span>
<span class="sd">    Statistics 15(2) 111-142.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">rmse_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">obs_max</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="n">obs_min</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rmse_value</span> <span class="o">/</span> <span class="p">(</span><span class="n">obs_max</span> <span class="o">-</span> <span class="n">obs_min</span><span class="p">)</span></div>


<div class="viewcode-block" id="nrmse_mean"><a class="viewcode-back" href="../../api/hydrostats.metrics.nrmse_mean.html#hydrostats.metrics.nrmse_mean">[docs]</a><span class="k">def</span> <span class="nf">nrmse_mean</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the range normalized root mean square error between the simulated and observed data.</span>

<span class="sd">    **Range:** 0 ≤ NRMSE &lt; inf.</span>

<span class="sd">    **Notes:** This metric is the RMSE normalized by the mean of the observed time series (x).</span>
<span class="sd">    Normalizing allows comparison between data sets with different scales.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Pontius, R.G., Thontteh, O., Chen, H., 2008. Components of information for multiple</span>
<span class="sd">    resolution comparison between maps that share a real variable. Environmental and Ecological</span>
<span class="sd">    Statistics 15(2) 111-142.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">rmse_value</span> <span class="o">=</span> <span class="n">rmse</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">=</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="o">=</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="n">obs_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">rmse_value</span> <span class="o">/</span> <span class="n">obs_mean</span></div>


<div class="viewcode-block" id="nrmse_iqr"><a class="viewcode-back" href="../../api/hydrostats.metrics.nrmse_iqr.html#hydrostats.metrics.nrmse_iqr">[docs]</a><span class="k">def</span> <span class="nf">nrmse_iqr</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the range normalized root mean square error between the simulated and observed data.</span>

<span class="sd">    **Range:** 0 ≤ NRMSE &lt; inf.</span>

<span class="sd">    **Notes:** This metric is the RMSE normalized by the range of the observed time series (x).</span>
<span class="sd">    Normalizing allows comparison between data sets with different scales. The NRMSEquartile is</span>
<span class="sd">    the least sensitive to outliers of the three normalized rmse metrics.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Pontius, R.G., Thontteh, O., Chen, H., 2008. Components of information for multiple</span>
<span class="sd">    resolution comparison between maps that share a real variable. Environmental and Ecological</span>
<span class="sd">    Statistics 15(2) 111-142.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">rmse_value</span> <span class="o">=</span> <span class="n">rmse</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">=</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="o">=</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="n">q1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">observed_array</span><span class="p">,</span> <span class="mi">25</span><span class="p">)</span>
    <span class="n">q3</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">percentile</span><span class="p">(</span><span class="n">observed_array</span><span class="p">,</span> <span class="mi">75</span><span class="p">)</span>
    <span class="n">iqr</span> <span class="o">=</span> <span class="n">q3</span> <span class="o">-</span> <span class="n">q1</span>
    <span class="k">return</span> <span class="n">rmse_value</span> <span class="o">/</span> <span class="n">iqr</span></div>


<span class="k">def</span> <span class="nf">irmse</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the inertial root mean square error (IRMSE) between the simulated and observed data.</span>

<span class="sd">    **Range:** 0 ≤ IRMSE &lt; inf, lower is better.</span>

<span class="sd">    **Notes:** This metric is the RMSE devided by by the standard deviation of the gradient of the</span>
<span class="sd">    observed timeseries data. This metric is meant to be help understand the ability of the model</span>
<span class="sd">    to predict changes in observation. Difficult to interpret and must be compared to the</span>
<span class="sd">    RMSE in order to understand fully.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when</span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Daga, M., Deo, M.C., 2009. Alternative data-driven methods to estimate wind from waves by</span>
<span class="sd">    inverse modeling. Natural Hazards 49(2) 293-310.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="c1"># Getting the gradient of the observed data</span>
    <span class="n">obs_len</span> <span class="o">=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span>
    <span class="n">obs_grad</span> <span class="o">=</span> <span class="n">observed_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:</span><span class="n">obs_len</span><span class="p">]</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">[</span><span class="n">obs_len</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>

    <span class="c1"># Standard deviation of the gradient</span>
    <span class="n">obs_grad_std</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">obs_grad</span><span class="p">)</span>

    <span class="c1"># Divide RMSE by the standard deviation of the gradient of the observed data</span>
    <span class="n">rmse_value</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">rmse_value</span> <span class="o">/</span> <span class="n">obs_grad_std</span>


<div class="viewcode-block" id="mase"><a class="viewcode-back" href="../../api/hydrostats.metrics.mase.html#hydrostats.metrics.mase">[docs]</a><span class="k">def</span> <span class="nf">mase</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the mean absolute scaled error between the simulated and observed data.</span>

<span class="sd">    **Range:**</span>

<span class="sd">    **Notes:**</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Hyndman, R.J., Koehler, A.B., 2006. Another look at measures of forecast accuracy.</span>
<span class="sd">    International Journal of Forecasting 22(4) 679-688.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>

    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">start</span> <span class="o">=</span> <span class="n">m</span>
    <span class="n">end</span> <span class="o">=</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="n">m</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span><span class="p">[</span><span class="n">start</span><span class="p">:</span><span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">]</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">[:</span><span class="n">end</span><span class="p">])</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span><span class="p">)</span> <span class="o">/</span> <span class="n">end</span><span class="p">)</span></div>


<div class="viewcode-block" id="pearson_r"><a class="viewcode-back" href="../../api/hydrostats.metrics.pearson_r.html#hydrostats.metrics.pearson_r">[docs]</a><span class="k">def</span> <span class="nf">pearson_r</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the pearson correlation coefficient.</span>

<span class="sd">    **Range:** -1 ≤ R (Pearson) ≤ 1. 1 indicates perfect postive correlation, 0 indicates</span>
<span class="sd">    complete randomness, -1 indicate perfect negative correlation.</span>

<span class="sd">    **Notes:** The pearson r coefficient measures linear correlation. It can be affected negatively</span>
<span class="sd">    by outliers.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="c1"># Checking and cleaning the data</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">sim_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
    <span class="n">obs_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>

    <span class="n">top</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">obs_mean</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">sim_mean</span><span class="p">))</span>
    <span class="n">bot1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">obs_mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">bot2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">sim_mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">top</span> <span class="o">/</span> <span class="p">(</span><span class="n">bot1</span> <span class="o">*</span> <span class="n">bot2</span><span class="p">)</span></div>


<div class="viewcode-block" id="spearman_r"><a class="viewcode-back" href="../../api/hydrostats.metrics.spearman_r.html#hydrostats.metrics.spearman_r">[docs]</a><span class="k">def</span> <span class="nf">spearman_r</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
               <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the spearman rank correlation coefficient.</span>

<span class="sd">    **Range:** -1 ≤ R (Pearson) ≤ 1. 1 indicates perfect postive correlation, 0 indicates</span>
<span class="sd">    complete randomness, -1 indicate perfect negative correlation.</span>

<span class="sd">    **Notes:** The spearman r coefficient measures the monotomic relation between simulated and</span>
<span class="sd">    observed data. Because it uses a nonparametric measure of rank correlation, it is less</span>
<span class="sd">    influenced by outliers than the pearson correlation coefficient.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Spearman C (1904). &quot;The proof and measurement of association between two things&quot;. American</span>
<span class="sd">    Journal of Psychology. 15: 72–101. doi:10.2307/1412159</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">rank_sim</span> <span class="o">=</span> <span class="n">rankdata</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
    <span class="n">rank_obs</span> <span class="o">=</span> <span class="n">rankdata</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>

    <span class="n">mean_rank_sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rank_sim</span><span class="p">)</span>
    <span class="n">mean_rank_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">rank_obs</span><span class="p">)</span>

    <span class="n">top</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">rank_obs</span> <span class="o">-</span> <span class="n">mean_rank_obs</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">rank_sim</span> <span class="o">-</span> <span class="n">mean_rank_sim</span><span class="p">))</span>
    <span class="n">bot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
        <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">rank_obs</span> <span class="o">-</span> <span class="n">mean_rank_obs</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">((</span><span class="n">rank_sim</span> <span class="o">-</span> <span class="n">mean_rank_sim</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">top</span> <span class="o">/</span> <span class="n">bot</span></div>


<div class="viewcode-block" id="r_squared"><a class="viewcode-back" href="../../api/hydrostats.metrics.r_squared.html#hydrostats.metrics.r_squared">[docs]</a><span class="k">def</span> <span class="nf">r_squared</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
              <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the the Coefficient of Determination (r2).</span>

<span class="sd">    **Range:** 0 ≤ r2 ≤ 1. 1 indicates perfect correlation, 0 indicates complete randomness.</span>

<span class="sd">    **Notes:** The Coefficient of Determination measures the linear relation between simulated and</span>
<span class="sd">    observed data. Because it is the pearson correlation coefficient squared, it is more heavily</span>
<span class="sd">    affected by outliers than the pearson correlation coefficient.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">observed_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">simulated_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span> <span class="o">*</span> <span class="n">b</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span></div>


<div class="viewcode-block" id="acc"><a class="viewcode-back" href="../../api/hydrostats.metrics.acc.html#hydrostats.metrics.acc">[docs]</a><span class="k">def</span> <span class="nf">acc</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the the anomaly correlation coefficient (ACC).</span>

<span class="sd">    **Range:** -1 ≤ ACC ≤ 1. -1 indicates perfect negative correlation of the variation pattern of</span>
<span class="sd">    the anomalies, 0 indicates complete randomness of the variation pattern of the anomalies,</span>
<span class="sd">    1 indicates perfect correlation of the variation pattern of the anomalies.</span>

<span class="sd">    **Notes:** Measures the correlation between the variation pattern of the simulated data</span>
<span class="sd">    compared to the observed data.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Langland, Rolf H., and Ryan N. Maue. “Recent Northern Hemisphere Mid-Latitude Medium-Range</span>
<span class="sd">    Deterministic Forecast Skill.” Tellus A: Dynamic Meteorology and Oceanography 64,</span>
<span class="sd">    no. 1 (2012): 17531.</span>
<span class="sd">    - Miyakoda, K., G. D. Hembree, R. F. Strickler, and I. Shulman. “Cumulative Results of Extended</span>
<span class="sd">    Forecast Experiments I. Model Performance for Winter Cases.” Monthly Weather Review 100, no. 12</span>
<span class="sd">    (1972): 836–55.</span>
<span class="sd">    - Murphy, Allan H., and Edward S. Epstein. “Skill Scores and Correlation Coefficients in Model</span>
<span class="sd">    Verification.” Monthly Weather Review 117, no. 3 (1989): 572–82.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">simulated_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">observed_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span> <span class="o">*</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">a</span><span class="p">,</span> <span class="n">b</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span></div>


<div class="viewcode-block" id="mape"><a class="viewcode-back" href="../../api/hydrostats.metrics.mape.html#hydrostats.metrics.mape">[docs]</a><span class="k">def</span> <span class="nf">mape</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the the mean absolute percentage error (MAPE).</span>

<span class="sd">    **Range:** 0% ≤ MAPE ≤ 100%. 100% indicates perfect correlation, 0% indicates complete</span>
<span class="sd">    randomness.</span>

<span class="sd">    **Notes:**</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span>
    <span class="k">return</span> <span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="mapd"><a class="viewcode-back" href="../../api/hydrostats.metrics.mapd.html#hydrostats.metrics.mapd">[docs]</a><span class="k">def</span> <span class="nf">mapd</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the the mean absolute percentage deviation (MAPE).</span>

<span class="sd">    **Range:**</span>

<span class="sd">    **Notes:**</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">/</span> <span class="n">b</span></div>


<div class="viewcode-block" id="maape"><a class="viewcode-back" href="../../api/hydrostats.metrics.maape.html#hydrostats.metrics.maape">[docs]</a><span class="k">def</span> <span class="nf">maape</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
          <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the the Mean Arctangent Absolute Percentage Error (MAAPE).</span>

<span class="sd">    **Range:** 0 ≤ MAAPE &lt; π/2, does not indicate bias, smaller is better.</span>

<span class="sd">    **Notes:** Represents the mean absolute error as a percentage of the observed values. Handles</span>
<span class="sd">    0s in the observed data. This metric is not as biased as MAPE by under-over predictions.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Kim, S., Kim, H., 2016. A new metric of absolute percentage error for intermittent demand</span>
<span class="sd">    forecasts. International Journal of Forecasting 32(3) 669-679.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">arctan</span><span class="p">(</span><span class="n">b</span><span class="p">))</span></div>


<div class="viewcode-block" id="smape1"><a class="viewcode-back" href="../../api/hydrostats.metrics.smape1.html#hydrostats.metrics.smape1">[docs]</a><span class="k">def</span> <span class="nf">smape1</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the the Symmetric Mean Absolute Percentage Error (1) (SMAPE1).</span>

<span class="sd">    **Range:** 0 ≤ SMAPE1 &lt; 200%, does not indicate bias, smaller is better, symmetrical.</span>

<span class="sd">    **Notes:** This metric is an adjusted version of the MAPE.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Flores, B.E., 1986. A pragmatic view of accuracy measurement in forecasting. Omega 14(2)</span>
<span class="sd">    93-98.</span>
<span class="sd">    - Goodwin, P., Lawton, R., 1999. On the asymmetry of the symmetric MAPE. International Journal</span>
<span class="sd">    of Forecasting 15(4) 405-408.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="n">c</span><span class="p">)</span></div>


<div class="viewcode-block" id="smape2"><a class="viewcode-back" href="../../api/hydrostats.metrics.smape2.html#hydrostats.metrics.smape2">[docs]</a><span class="k">def</span> <span class="nf">smape2</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the the Symmetric Mean Absolute Percentage Error (2) (SMAPE2).</span>

<span class="sd">    **Range:** 0 ≤ SMAPE1 &lt; 200%, does not indicate bias, smaller is better, symmetrical.</span>

<span class="sd">    **Notes:** This metric is an adjusted version of the MAPE with only positive metric values.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Flores, B.E., 1986. A pragmatic view of accuracy measurement in forecasting. Omega 14(2)</span>
<span class="sd">    93-98.</span>
<span class="sd">    - Goodwin, P., Lawton, R., 1999. On the asymmetry of the symmetric MAPE. International Journal</span>
<span class="sd">    of Forecasting 15(4) 405-408.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">+</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="mi">2</span>
    <span class="n">c</span> <span class="o">=</span> <span class="mi">100</span> <span class="o">/</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span>
    <span class="k">return</span> <span class="n">c</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">))</span></div>


<div class="viewcode-block" id="d"><a class="viewcode-back" href="../../api/hydrostats.metrics.d.html#hydrostats.metrics.d">[docs]</a><span class="k">def</span> <span class="nf">d</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
      <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the the index of agreement (d).</span>

<span class="sd">    **Range:** 0 ≤ d &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    **Notes:** This metric is a modified approach to the Nash-Sutcliffe Efficiency metric.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Legates, D.R., McCabe Jr, G.J., 1999. Evaluating the use of “goodness‐of‐fit” Measures in</span>
<span class="sd">    hydrologic and hydroclimatic model validation. Water Resources Research 35(1) 233-241.</span>
<span class="sd">    - Willmott, C.J., Robeson, S.M., Matsuura, K., 2012. A refined index of model performance.</span>
<span class="sd">    International Journal of Climatology 32(13) 2088-2094.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">simulated_array</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">))</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">))</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span></div>


<div class="viewcode-block" id="d1"><a class="viewcode-back" href="../../api/hydrostats.metrics.d1.html#hydrostats.metrics.d1">[docs]</a><span class="k">def</span> <span class="nf">d1</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
       <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the the index of agreement (d1).</span>

<span class="sd">    **Range:** 0 ≤ d &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    **Notes:** This metric is a modified approach to the Nash-Sutcliffe Efficiency metric. Compared</span>
<span class="sd">    to the other index of agreement (d) it has a reduced impact of outliers.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Willmott, C.J., Robeson, S.M., Matsuura, K., 2012. A refined index of model performance.</span>
<span class="sd">    International Journal of Climatology 32(13) 2088-2094.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">obs_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">obs_mean</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">obs_mean</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span></div>


<div class="viewcode-block" id="dr"><a class="viewcode-back" href="../../api/hydrostats.metrics.dr.html#hydrostats.metrics.dr">[docs]</a><span class="k">def</span> <span class="nf">dr</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
       <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the the refined index of agreement (dr).</span>

<span class="sd">    **Range:** -1 ≤ dr &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    **Notes:** This metric was created to address issues in the index of agreement and the</span>
<span class="sd">    Nash-Sutcliffe efficiency metric. It is easy to interpret.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Willmott, C.J., Robeson, S.M., Matsuura, K., 2012. A refined index of model performance.</span>
<span class="sd">    International Journal of Climatology 32(13) 2088-2094.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">mean</span><span class="p">()))</span>
    <span class="k">if</span> <span class="n">a</span> <span class="o">&lt;=</span> <span class="n">b</span><span class="p">:</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">return</span> <span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="n">a</span><span class="p">)</span> <span class="o">-</span> <span class="mi">1</span></div>


<div class="viewcode-block" id="drel"><a class="viewcode-back" href="../../api/hydrostats.metrics.drel.html#hydrostats.metrics.drel">[docs]</a><span class="k">def</span> <span class="nf">drel</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the the relative index of agreement (drel).</span>

<span class="sd">    **Range:** 0 ≤ drel &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    **Notes:** Instead of absolute differences, this metric uses relative differences.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Krause, P., Boyle, D., Bäse, F., 2005. Comparison of different efficiency criteria for</span>
<span class="sd">    hydrological model assessment. Advances in geosciences 5 89-97.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="p">((</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">))</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">))</span>
    <span class="n">e</span> <span class="o">=</span> <span class="p">((</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">e</span><span class="p">))</span></div>


<div class="viewcode-block" id="dmod"><a class="viewcode-back" href="../../api/hydrostats.metrics.dmod.html#hydrostats.metrics.dmod">[docs]</a><span class="k">def</span> <span class="nf">dmod</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the the modified index of agreement (dmod).</span>

<span class="sd">    **Range:** 0 ≤ dmod &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    **Notes:** When j=1, this metric is the same as d1. As j becomes larger, outliers have a larger</span>
<span class="sd">    impact on the value.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Krause, P., Boyle, D., Bäse, F., 2005. Comparison of different efficiency criteria for</span>
<span class="sd">    hydrological model assessment. Advances in geosciences 5 89-97.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">))</span> <span class="o">**</span> <span class="n">j</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">))</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">))</span>
    <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">b</span> <span class="o">+</span> <span class="n">c</span><span class="p">)</span> <span class="o">**</span> <span class="n">j</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">e</span><span class="p">))</span></div>


<div class="viewcode-block" id="watt_m"><a class="viewcode-back" href="../../api/hydrostats.metrics.watt_m.html#hydrostats.metrics.watt_m">[docs]</a><span class="k">def</span> <span class="nf">watt_m</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute Watterson&#39;s M (M).</span>

<span class="sd">    **Range:** -1 ≤ M &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    # **Notes:**</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Watterson, I.G., 1996. Non‐dimensional measures of climate model performance. International</span>
<span class="sd">    Journal of Climatology 16(4) 379-391.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">pi</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">mse</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">e</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">f</span> <span class="o">=</span> <span class="n">c</span> <span class="o">+</span> <span class="n">e</span>
    <span class="k">return</span> <span class="n">a</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">arcsin</span><span class="p">(</span><span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">b</span> <span class="o">/</span> <span class="n">f</span><span class="p">))</span></div>


<div class="viewcode-block" id="mb_r"><a class="viewcode-back" href="../../api/hydrostats.metrics.mb_r.html#hydrostats.metrics.mb_r">[docs]</a><span class="k">def</span> <span class="nf">mb_r</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute Mielke-Berry R value (MB R).</span>

<span class="sd">    **Range:** 0 ≤ MB R &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    **Notes:** Compares prediction to probability it arose by chance.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Berry, K.J., Mielke, P.W., 1988. A Generalization of Cohen&#39;s Kappa Agreement Measure to</span>
<span class="sd">    Interval Measurement and Multiple Raters. Educational and Psychological Measurement 48(4)</span>
<span class="sd">    921-933.</span>
<span class="sd">    - Mielke, P.W., Berry, K.J., 2007. Permutation methods: a distance function approach.</span>
<span class="sd">    Springer Science &amp; Business Media.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="nd">@njit</span><span class="p">(</span><span class="n">parallel</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
    <span class="k">def</span> <span class="nf">numba_loop</span><span class="p">(</span><span class="n">simulated_array_numba</span><span class="p">,</span> <span class="n">observed_array_numba</span><span class="p">):</span>
        <span class="sd">&quot;&quot;&quot;Using numba for the double for loop&quot;&quot;&quot;</span>
        <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array_numba</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array_numba</span><span class="p">)</span>
        <span class="n">size_numba</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array_numba</span><span class="p">)</span>
        <span class="n">total_numba</span> <span class="o">=</span> <span class="mf">0.</span>
        <span class="k">for</span> <span class="n">ii</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">size_numba</span><span class="p">):</span>
            <span class="n">observed</span> <span class="o">=</span> <span class="n">observed_array_numba</span><span class="p">[</span><span class="n">ii</span><span class="p">]</span>
            <span class="k">for</span> <span class="n">jj</span> <span class="ow">in</span> <span class="n">prange</span><span class="p">(</span><span class="n">size_numba</span><span class="p">):</span>
                <span class="n">total_numba</span> <span class="o">+=</span> <span class="nb">abs</span><span class="p">(</span><span class="n">simulated_array_numba</span><span class="p">[</span><span class="n">jj</span><span class="p">]</span> <span class="o">-</span> <span class="n">observed</span><span class="p">)</span>
        <span class="k">return</span> <span class="n">total_numba</span><span class="p">,</span> <span class="n">size_numba</span>

    <span class="c1"># Using NumPy for the vectorized calculations</span>
    <span class="n">total</span><span class="p">,</span> <span class="n">size</span> <span class="o">=</span> <span class="n">numba_loop</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">mae</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">*</span> <span class="n">size</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">/</span> <span class="n">total</span><span class="p">)</span></div>


<div class="viewcode-block" id="nse"><a class="viewcode-back" href="../../api/hydrostats.metrics.nse.html#hydrostats.metrics.nse">[docs]</a><span class="k">def</span> <span class="nf">nse</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the Nash-Sutcliffe Efficiency.</span>

<span class="sd">    **Range:** -inf &lt; NSE &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    **Notes:** The Nash-Sutcliffe efficiency metric compares prediction values to naive preditions</span>
<span class="sd">    (i.e. average value).</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Krause, P., Boyle, D., Bäse, F., 2005. Comparison of different efficiency criteria for</span>
<span class="sd">    hydrological model assessment. Advances in geosciences 5 89-97.</span>
<span class="sd">    - McCuen, R.H., Knight, Z., Cutter, A.G., 2006. Evaluation of the Nash-Sutcliffe Efficiency</span>
<span class="sd">    Index. Journal of Hydraulic Engineering.</span>
<span class="sd">    - Nash, J.E., Sutcliffe, J.V., 1970. River flow forecasting through conceptual models part</span>
<span class="sd">    I — A discussion of principles. Journal of Hydrology 282-290.</span>
<span class="sd">    - Willmott, C.J., Robeson, S.M., Matsuura, K., 2012. A refined index of model performance.</span>
<span class="sd">    International Journal of Climatology 32(13) 2088-2094.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)))</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span><span class="p">))</span></div>


<div class="viewcode-block" id="nse_mod"><a class="viewcode-back" href="../../api/hydrostats.metrics.nse_mod.html#hydrostats.metrics.nse_mod">[docs]</a><span class="k">def</span> <span class="nf">nse_mod</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the modified Nash-Sutcliffe efficiency (NSE mod).</span>

<span class="sd">    **Range:** -inf &lt; NSE (mod) &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    **Notes:** The modified Nash-Sutcliffe efficiency metric gives less weight to outliers if j=1,</span>
<span class="sd">    or more weight to outliers if j is higher. Generally, j=1.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Krause, P., Boyle, D., Bäse, F., 2005. Comparison of different efficiency criteria for</span>
<span class="sd">    hydrological model assessment. Advances in geosciences 5 89-97.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">))</span> <span class="o">**</span> <span class="n">j</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)))</span> <span class="o">**</span> <span class="n">j</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span><span class="p">))</span></div>


<div class="viewcode-block" id="nse_rel"><a class="viewcode-back" href="../../api/hydrostats.metrics.nse_rel.html#hydrostats.metrics.nse_rel">[docs]</a><span class="k">def</span> <span class="nf">nse_rel</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
            <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the relative Nash-Sutcliffe efficiency (NSE rel).</span>

<span class="sd">    **Range:** -inf &lt; NSE (rel) &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    **Notes:** The modified Nash-Sutcliffe efficiency metric gives less weight to outliers if j=1,</span>
<span class="sd">    or more weight to outliers if j is higher. Generally, j=1.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when </span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when </span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Krause, P., Boyle, D., Bäse, F., 2005. Comparison of different efficiency criteria for</span>
<span class="sd">    hydrological model assessment. Advances in geosciences 5 89-97.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="n">observed_array</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="n">b</span> <span class="o">=</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">((</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">))</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)))</span> <span class="o">**</span> <span class="mi">2</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span><span class="p">))</span></div>


<div class="viewcode-block" id="kge_2009"><a class="viewcode-back" href="../../api/hydrostats.metrics.kge_2009.html#hydrostats.metrics.kge_2009">[docs]</a><span class="k">def</span> <span class="nf">kge_2009</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the Kling-Gupta efficiency (2009).</span>

<span class="sd">    **Range:** -inf &lt; KGE (2009) &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    **Notes:** Gupta et al. (2009) created this metric to demonstrate the relative importance of</span>
<span class="sd">    the three components of the NSE, which are correlation, bias and variability. This was done</span>
<span class="sd">    with hydrologic modeling as the context. This metric is meant to address issues with the NSE.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    s: *tuple of length three*</span>
<span class="sd">    &gt; representing the scaling factors to be used for re-scaling the Pearson product-moment</span>
<span class="sd">    correlation coefficient (r), Alpha, and Beta, respectively.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when</span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Gupta, H. V., Kling, H., Yilmaz, K. K., &amp; Martinez, G. F. (2009). Decomposition of the mean</span>
<span class="sd">    squared error and NSE performance criteria: Implications for improving hydrological modelling.</span>
<span class="sd">    Journal of Hydrology, 377(1-2), 80-91.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="c1"># Means</span>
    <span class="n">sim_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
    <span class="n">obs_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>

    <span class="c1"># Standard Deviations</span>
    <span class="n">sim_sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
    <span class="n">obs_sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>

    <span class="c1"># Pearson R</span>
    <span class="n">top_pr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">obs_mean</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">sim_mean</span><span class="p">))</span>
    <span class="n">bot1_pr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">obs_mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">bot2_pr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">sim_mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">pr</span> <span class="o">=</span> <span class="n">top_pr</span> <span class="o">/</span> <span class="p">(</span><span class="n">bot1_pr</span> <span class="o">*</span> <span class="n">bot2_pr</span><span class="p">)</span>

    <span class="c1"># Ratio between mean of simulated and observed data</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">sim_mean</span> <span class="o">/</span> <span class="n">obs_mean</span>

    <span class="c1"># Relative variability between simulated and observed values</span>
    <span class="n">alpha</span> <span class="o">=</span> <span class="n">sim_sigma</span> <span class="o">/</span> <span class="n">obs_sigma</span>

    <span class="k">if</span> <span class="n">obs_mean</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">obs_sigma</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">kge</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">pr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">alpha</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">beta</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">obs_mean</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s1">&#39;Warning: The observed data mean is 0. Therefore, Beta is infinite and the KGE &#39;</span>
                <span class="s1">&#39;value cannot be computed.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obs_sigma</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s1">&#39;Warning: The observed data standard deviation is 0. Therefore, Alpha is infinite &#39;</span>
                <span class="s1">&#39;and the KGE value cannot be computed.&#39;</span><span class="p">)</span>
        <span class="n">kge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="n">kge</span></div>


<div class="viewcode-block" id="kge_2012"><a class="viewcode-back" href="../../api/hydrostats.metrics.kge_2012.html#hydrostats.metrics.kge_2012">[docs]</a><span class="k">def</span> <span class="nf">kge_2012</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">s</span><span class="o">=</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">1</span><span class="p">),</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the Kling-Gupta efficiency (2012).</span>

<span class="sd">    **Range:** -inf &lt; KGE (2012) &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    **Notes:** The modified version of the KGE (2009). Kling proposed this version to avoid</span>
<span class="sd">    cross-correlation between bias and variability ratios.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    s: *tuple of length three*</span>
<span class="sd">    &gt; representing the scaling factors to be used for re-scaling the Pearson product-moment</span>
<span class="sd">    correlation coefficient (r), Alpha, and Beta, respectively.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when</span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Kling, H., Fuchs, M., &amp; Paulin, M. (2012). Runoff conditions in the upper Danube basin under</span>
<span class="sd">    an ensemble of climate change scenarios. Journal of Hydrology, 424, 264-277.</span>

<span class="sd">    &quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="c1"># Means</span>
    <span class="n">sim_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
    <span class="n">obs_mean</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>

    <span class="c1"># Standard Deviations</span>
    <span class="n">sim_sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
    <span class="n">obs_sigma</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">std</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>

    <span class="c1"># Pearson R</span>
    <span class="n">top_pr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">obs_mean</span><span class="p">)</span> <span class="o">*</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">sim_mean</span><span class="p">))</span>
    <span class="n">bot1_pr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">obs_mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">bot2_pr</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">((</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">sim_mean</span><span class="p">)</span> <span class="o">**</span> <span class="mi">2</span><span class="p">))</span>
    <span class="n">pr</span> <span class="o">=</span> <span class="n">top_pr</span> <span class="o">/</span> <span class="p">(</span><span class="n">bot1_pr</span> <span class="o">*</span> <span class="n">bot2_pr</span><span class="p">)</span>

    <span class="c1"># Ratio between mean of simulated and observed data</span>
    <span class="n">beta</span> <span class="o">=</span> <span class="n">sim_mean</span> <span class="o">/</span> <span class="n">obs_mean</span>

    <span class="c1"># CV is the coefficient of variation (standard deviation / mean)</span>
    <span class="n">sim_cv</span> <span class="o">=</span> <span class="n">sim_sigma</span> <span class="o">/</span> <span class="n">sim_mean</span>
    <span class="n">obs_cv</span> <span class="o">=</span> <span class="n">obs_sigma</span> <span class="o">/</span> <span class="n">obs_mean</span>

    <span class="c1"># Variability Ratio, or the ratio of simulated CV to observed CV</span>
    <span class="n">gam</span> <span class="o">=</span> <span class="n">sim_cv</span> <span class="o">/</span> <span class="n">obs_cv</span>

    <span class="k">if</span> <span class="n">obs_mean</span> <span class="o">!=</span> <span class="mi">0</span> <span class="ow">and</span> <span class="n">obs_sigma</span> <span class="o">!=</span> <span class="mi">0</span><span class="p">:</span>
        <span class="n">kge</span> <span class="o">=</span> <span class="mi">1</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span>
            <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">pr</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">gam</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span> <span class="o">+</span> <span class="p">(</span><span class="n">s</span><span class="p">[</span><span class="mi">2</span><span class="p">]</span> <span class="o">*</span> <span class="p">(</span><span class="n">beta</span> <span class="o">-</span> <span class="mi">1</span><span class="p">))</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">if</span> <span class="n">obs_mean</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s1">&#39;Warning: The observed data mean is 0. Therefore, Beta is infinite and the KGE &#39;</span>
                <span class="s1">&#39;value cannot be computed.&#39;</span><span class="p">)</span>
        <span class="k">if</span> <span class="n">obs_sigma</span> <span class="o">==</span> <span class="mi">0</span><span class="p">:</span>
            <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
                <span class="s1">&#39;Warning: The observed data standard deviation is 0. Therefore, Gamma is infinite &#39;</span>
                <span class="s1">&#39;and the KGE value cannot be computed.&#39;</span><span class="p">)</span>
        <span class="n">kge</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

    <span class="k">return</span> <span class="n">kge</span></div>


<div class="viewcode-block" id="lm_index"><a class="viewcode-back" href="../../api/hydrostats.metrics.lm_index.html#hydrostats.metrics.lm_index">[docs]</a><span class="k">def</span> <span class="nf">lm_index</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">obs_bar_p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the Legate-McCabe Efficiency Index.</span>

<span class="sd">    **Range:** 0 ≤ E1&#39; &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    **Notes:** The obs_bar_p argument represents a seasonal or other selected average.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    obs_bar_p: *float*</span>
<span class="sd">    &gt; Seasonal or other selected average. If None, the mean of the observed array will be used.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when</span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Legates, D.R., McCabe Jr, G.J., 1999. Evaluating the use of “goodness‐of‐fit” Measures in</span>
<span class="sd">    hydrologic and hydroclimatic model validation. Water Resources Research 35(1) 233-241.</span>
<span class="sd">    Lehmann, E.L., Casella, G., 1998. Springer Texts in Statistics. Springer-Verlag, New York.</span>


<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">mean_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">obs_bar_p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">obs_bar_p</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">mean_obs</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span><span class="p">))</span></div>


<div class="viewcode-block" id="d1_p"><a class="viewcode-back" href="../../api/hydrostats.metrics.d1_p.html#hydrostats.metrics.d1_p">[docs]</a><span class="k">def</span> <span class="nf">d1_p</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">obs_bar_p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
         <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the Legate-McCabe Index of Agreement.</span>

<span class="sd">    **Range:** 0 ≤ d1&#39; &lt; 1, does not indicate bias, larger is better.</span>

<span class="sd">    **Notes:** The obs_bar_p argument represents a seasonal or other selected average.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    obs_bar_p: *float*</span>
<span class="sd">    &gt; Seasonal or other selected average. If None, the mean of the observed array will be used.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when</span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Legates, D.R., McCabe Jr, G.J., 1999. Evaluating the use of “goodness‐of‐fit” Measures in</span>
<span class="sd">    hydrologic and hydroclimatic model validation. Water Resources Research 35(1) 233-241.</span>
<span class="sd">    Lehmann, E.L., Casella, G., 1998. Springer Texts in Statistics. Springer-Verlag, New York.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="k">if</span> <span class="n">obs_bar_p</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">simulated_array</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">obs_bar_p</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">obs_bar_p</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">mean_obs</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
        <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">simulated_array</span><span class="p">)</span>
        <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">mean_obs</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">mean_obs</span><span class="p">)</span>
        <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">a</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">b</span><span class="p">))</span></div>


<div class="viewcode-block" id="ve"><a class="viewcode-back" href="../../api/hydrostats.metrics.ve.html#hydrostats.metrics.ve">[docs]</a><span class="k">def</span> <span class="nf">ve</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
       <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the Volumetric Efficiency (VE).</span>

<span class="sd">    **Range:** 0 ≤ VE &lt; 1 smaller is better, does not indicate bias.</span>

<span class="sd">    **Notes:** Represents the error as a percentage of flow.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when</span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Criss, R.E., Winston, W.E., 2008. Do Nash values have value? Discussion and alternate</span>
<span class="sd">    proposals. Hydrological Processes 22(14) 2723.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sum</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="mi">1</span> <span class="o">-</span> <span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="sa"><a class="viewcode-back" href="../../api/hydrostats.metrics.sa.html#hydrostats.metrics.sa">[docs]</a><span class="k">def</span> <span class="nf">sa</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
       <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the Spectral Angle (SA).</span>

<span class="sd">    **Range:** -π/2 ≤ SA &lt; π/2, closer to 0 is better.</span>

<span class="sd">    **Notes:** The spectral angle metric measures the angle between the two vectors in hyperspace.</span>
<span class="sd">    It indicates how well the shape of the two series match – not magnitude.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when</span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Robila, S.A., Gershman, A., 2005. Spectral matching accuracy in processing hyperspectral</span>
<span class="sd">    data, Signals, Circuits and Systems, 2005. ISSCS 2005. International Symposium on. IEEE,</span>
<span class="sd">    pp. 163-166.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span></div>


<div class="viewcode-block" id="sc"><a class="viewcode-back" href="../../api/hydrostats.metrics.sc.html#hydrostats.metrics.sc">[docs]</a><span class="k">def</span> <span class="nf">sc</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
       <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the Spectral Correlation (SC).</span>

<span class="sd">    **Range:** -π/2 ≤ SA &lt; π/2, closer to 0 is better.</span>

<span class="sd">    **Notes:** The spectral correlation metric measures the angle between the two vectors in</span>
<span class="sd">    hyperspace. It indicates how well the shape of the two series match – not magnitude.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when</span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Robila, S.A., Gershman, A., 2005. Spectral matching accuracy in processing hyperspectral</span>
<span class="sd">    data, Signals, Circuits and Systems, 2005. ISSCS 2005. International Symposium on. IEEE,</span>
<span class="sd">    pp. 163-166.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">),</span> <span class="n">simulated_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">))</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">observed_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">))</span>
    <span class="n">c</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">))</span>
    <span class="n">e</span> <span class="o">=</span> <span class="n">b</span> <span class="o">*</span> <span class="n">c</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">e</span><span class="p">)</span></div>


<div class="viewcode-block" id="sid"><a class="viewcode-back" href="../../api/hydrostats.metrics.sid.html#hydrostats.metrics.sid">[docs]</a><span class="k">def</span> <span class="nf">sid</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the Spectral Information Divergence (SID).</span>

<span class="sd">    **Range:** -π/2 ≤ SID &lt; π/2, closer to 0 is better.</span>

<span class="sd">    **Notes:** The spectral information divergence measures the angle between the two vectors in</span>
<span class="sd">    hyperspace. It indicates how well the shape of the two series match – not magnitude.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when</span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Robila, S.A., Gershman, A., 2005. Spectral matching accuracy in processing hyperspectral</span>
<span class="sd">    data, Signals, Circuits and Systems, 2005. ISSCS 2005. International Symposium on. IEEE,</span>
<span class="sd">    pp. 163-166.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">first</span> <span class="o">=</span> <span class="p">(</span><span class="n">observed_array</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">))</span> <span class="o">-</span> <span class="p">(</span>
                <span class="n">simulated_array</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">))</span>
    <span class="n">second1</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">observed_array</span><span class="p">))</span>
    <span class="n">second2</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log10</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">first</span><span class="p">,</span> <span class="n">second1</span> <span class="o">-</span> <span class="n">second2</span><span class="p">)</span></div>


<div class="viewcode-block" id="sga"><a class="viewcode-back" href="../../api/hydrostats.metrics.sga.html#hydrostats.metrics.sga">[docs]</a><span class="k">def</span> <span class="nf">sga</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    Compute the Spectral Gradient Angle (SGA).</span>

<span class="sd">    **Range:** -π/2 ≤ SID &lt; π/2, closer to 0 is better.</span>

<span class="sd">    **Notes:** The spectral gradient angle measures the angle between the two vectors in</span>
<span class="sd">    hyperspace. It indicates how well the shape of the two series match – not magnitude.</span>
<span class="sd">    SG is the gradient of the simulated or observed time series.</span>

<span class="sd">    **Parameters**</span>

<span class="sd">    simulated_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of simulated data from the time series.</span>

<span class="sd">    observed_array: *one dimensional ndarray*</span>
<span class="sd">    &gt; An array of observed data from the time series.</span>

<span class="sd">    replace_nan: *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace NaN values with in the two arrays. If None, when</span>
<span class="sd">    a NaN value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    replace_inf *float, optional*</span>
<span class="sd">    &gt; If given, indicates which value to replace Inf values with in the two arrays. If None, when</span>
<span class="sd">    an inf value is found at the i-th position in the observed OR simulated array, the i-th value</span>
<span class="sd">    of the observed and simulated array are removed before the computation.</span>

<span class="sd">    remove_neg *boolean, optional*</span>
<span class="sd">    &gt; If true, negative numbers will be removed from the observed and simulated arrays.</span>

<span class="sd">    remove_zero *boolean, optional*</span>
<span class="sd">    &gt; If true, zeros will be removed from the observed and simulated arrays.</span>

<span class="sd">    **References:**</span>

<span class="sd">    - Robila, S.A., Gershman, A., 2005. Spectral matching accuracy in processing hyperspectral</span>
<span class="sd">    data, Signals, Circuits and Systems, 2005. ISSCS 2005. International Symposium on. IEEE,</span>
<span class="sd">    pp. 163-166.</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">sgx</span> <span class="o">=</span> <span class="n">observed_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">[:</span><span class="n">observed_array</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">sgy</span> <span class="o">=</span> <span class="n">simulated_array</span><span class="p">[</span><span class="mi">1</span><span class="p">:]</span> <span class="o">-</span> <span class="n">simulated_array</span><span class="p">[:</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">-</span> <span class="mi">1</span><span class="p">]</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">dot</span><span class="p">(</span><span class="n">sgx</span><span class="p">,</span> <span class="n">sgy</span><span class="p">)</span>
    <span class="n">b</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sgx</span><span class="p">)</span> <span class="o">*</span> <span class="n">np</span><span class="o">.</span><span class="n">linalg</span><span class="o">.</span><span class="n">norm</span><span class="p">(</span><span class="n">sgy</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">arccos</span><span class="p">(</span><span class="n">a</span> <span class="o">/</span> <span class="n">b</span><span class="p">)</span></div>


<span class="c1">####################################################################################################</span>
<span class="c1">#               H Metrics: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985)               #</span>
<span class="c1">####################################################################################################</span>


<div class="viewcode-block" id="h1_mhe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h1_mhe.html#hydrostats.metrics.h1_mhe">[docs]</a><span class="k">def</span> <span class="nf">h1_mhe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;</span>

<span class="sd">    H1 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).</span>

<span class="sd">    &quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="n">observed_array</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">)</span></div>


<div class="viewcode-block" id="h1_ahe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h1_ahe.html#hydrostats.metrics.h1_ahe">[docs]</a><span class="k">def</span> <span class="nf">h1_ahe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H1 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="n">observed_array</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span></div>


<div class="viewcode-block" id="h1_rmshe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h1_rmshe.html#hydrostats.metrics.h1_rmshe">[docs]</a><span class="k">def</span> <span class="nf">h1_rmshe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H1 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="n">observed_array</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">h</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span></div>


<div class="viewcode-block" id="h2_mhe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h2_mhe.html#hydrostats.metrics.h2_mhe">[docs]</a><span class="k">def</span> <span class="nf">h2_mhe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H2 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="n">simulated_array</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">)</span></div>


<div class="viewcode-block" id="h2_ahe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h2_ahe.html#hydrostats.metrics.h2_ahe">[docs]</a><span class="k">def</span> <span class="nf">h2_ahe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H2 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="n">simulated_array</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span></div>


<div class="viewcode-block" id="h2_rmshe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h2_rmshe.html#hydrostats.metrics.h2_rmshe">[docs]</a><span class="k">def</span> <span class="nf">h2_rmshe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H2 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="n">simulated_array</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">h</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span></div>


<div class="viewcode-block" id="h3_mhe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h3_mhe.html#hydrostats.metrics.h3_mhe">[docs]</a><span class="k">def</span> <span class="nf">h3_mhe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H3 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">+</span> <span class="n">observed_array</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">)</span></div>


<div class="viewcode-block" id="h3_ahe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h3_ahe.html#hydrostats.metrics.h3_ahe">[docs]</a><span class="k">def</span> <span class="nf">h3_ahe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H3 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">+</span> <span class="n">observed_array</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span></div>


<div class="viewcode-block" id="h3_rmshe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h3_rmshe.html#hydrostats.metrics.h3_rmshe">[docs]</a><span class="k">def</span> <span class="nf">h3_rmshe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H3 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">+</span> <span class="n">observed_array</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">h</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span></div>


<div class="viewcode-block" id="h4_mhe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h4_mhe.html#hydrostats.metrics.h4_mhe">[docs]</a><span class="k">def</span> <span class="nf">h4_mhe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H4 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">*</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">)</span></div>


<div class="viewcode-block" id="h4_ahe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h4_ahe.html#hydrostats.metrics.h4_ahe">[docs]</a><span class="k">def</span> <span class="nf">h4_ahe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H4 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">*</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span></div>


<div class="viewcode-block" id="h4_rmshe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h4_rmshe.html#hydrostats.metrics.h4_rmshe">[docs]</a><span class="k">def</span> <span class="nf">h4_rmshe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H4 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">*</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">h</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span></div>


<div class="viewcode-block" id="h5_mhe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h5_mhe.html#hydrostats.metrics.h5_mhe">[docs]</a><span class="k">def</span> <span class="nf">h5_mhe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H5 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">top</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="n">bot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)))</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">top</span> <span class="o">/</span> <span class="n">bot</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">)</span></div>


<div class="viewcode-block" id="h5_ahe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h5_ahe.html#hydrostats.metrics.h5_ahe">[docs]</a><span class="k">def</span> <span class="nf">h5_ahe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H5 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">top</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="n">bot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)))</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">top</span> <span class="o">/</span> <span class="n">bot</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span></div>


<div class="viewcode-block" id="h5_rmshe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h5_rmshe.html#hydrostats.metrics.h5_rmshe">[docs]</a><span class="k">def</span> <span class="nf">h5_rmshe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H5 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">top</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">-</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="n">bot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">reciprocal</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)))</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">top</span> <span class="o">/</span> <span class="n">bot</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">h</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span></div>


<div class="viewcode-block" id="h6_mhe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h6_mhe.html#hydrostats.metrics.h6_mhe">[docs]</a><span class="k">def</span> <span class="nf">h6_mhe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H6 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">top</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">bot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">k</span><span class="p">)),</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">k</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">top</span> <span class="o">/</span> <span class="n">bot</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">)</span></div>


<div class="viewcode-block" id="h6_ahe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h6_ahe.html#hydrostats.metrics.h6_ahe">[docs]</a><span class="k">def</span> <span class="nf">h6_ahe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
           <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H6 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">top</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">bot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">k</span><span class="p">)),</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">k</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">top</span> <span class="o">/</span> <span class="n">bot</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span></div>


<div class="viewcode-block" id="h6_rmshe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h6_rmshe.html#hydrostats.metrics.h6_rmshe">[docs]</a><span class="k">def</span> <span class="nf">h6_rmshe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
             <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H6 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">top</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span>
    <span class="n">bot</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="mf">0.5</span> <span class="o">*</span> <span class="p">(</span><span class="mi">1</span> <span class="o">+</span> <span class="n">np</span><span class="o">.</span><span class="n">power</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">k</span><span class="p">)),</span> <span class="mi">1</span> <span class="o">/</span> <span class="n">k</span><span class="p">)</span>
    <span class="n">h</span> <span class="o">=</span> <span class="n">top</span> <span class="o">/</span> <span class="n">bot</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">h</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span></div>


<div class="viewcode-block" id="h7_mhe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h7_mhe.html#hydrostats.metrics.h7_mhe">[docs]</a><span class="k">def</span> <span class="nf">h7_mhe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H7 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">)</span></div>


<div class="viewcode-block" id="h7_ahe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h7_ahe.html#hydrostats.metrics.h7_ahe">[docs]</a><span class="k">def</span> <span class="nf">h7_ahe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H7 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span></div>


<div class="viewcode-block" id="h7_rmshe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h7_rmshe.html#hydrostats.metrics.h7_rmshe">[docs]</a><span class="k">def</span> <span class="nf">h7_rmshe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H7 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">min</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">h</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span></div>


<div class="viewcode-block" id="h8_mhe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h8_mhe.html#hydrostats.metrics.h8_mhe">[docs]</a><span class="k">def</span> <span class="nf">h8_mhe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H8 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">)</span></div>


<div class="viewcode-block" id="h8_ahe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h8_ahe.html#hydrostats.metrics.h8_ahe">[docs]</a><span class="k">def</span> <span class="nf">h8_ahe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
           <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H8 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span></div>


<div class="viewcode-block" id="h8_rmshe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h8_rmshe.html#hydrostats.metrics.h8_rmshe">[docs]</a><span class="k">def</span> <span class="nf">h8_rmshe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H8 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span> <span class="o">-</span> <span class="mi">1</span><span class="p">)</span> <span class="o">/</span> <span class="n">np</span><span class="o">.</span><span class="n">max</span><span class="p">(</span><span class="n">simulated_array</span> <span class="o">/</span> <span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">h</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span></div>


<span class="c1"># def h9(simulated_array, observed_array, h_type=&#39;mhe&#39;, k=1):</span>
<span class="c1">#     h = (simulated_array / observed_array - 1) / \</span>
<span class="c1">#         np.power(0.5 * (1 + np.power(simulated_array / observed_array, k)), 1 / k)</span>
<span class="c1">#     if h_type == &#39;mhe&#39;:</span>
<span class="c1">#         return h.mean()</span>
<span class="c1">#     elif h_type == &#39;ahe&#39;:</span>
<span class="c1">#         return np.abs(h).mean()</span>
<span class="c1">#     elif h_type == &#39;rmshe&#39;:</span>
<span class="c1">#         return np.sqrt((h**2).mean())</span>
<span class="c1">#     else:</span>
<span class="c1">#         raise HydrostatsError(&quot;The three types available are &#39;mhe&#39;, &#39;ahe&#39;, and &#39;rmshe&#39;.&quot;)</span>


<div class="viewcode-block" id="h10_mhe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h10_mhe.html#hydrostats.metrics.h10_mhe">[docs]</a><span class="k">def</span> <span class="nf">h10_mhe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H10 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">h</span><span class="p">)</span></div>


<div class="viewcode-block" id="h10_ahe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h10_ahe.html#hydrostats.metrics.h10_ahe">[docs]</a><span class="k">def</span> <span class="nf">h10_ahe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
            <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H10 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">abs</span><span class="p">(</span><span class="n">h</span><span class="p">))</span></div>


<div class="viewcode-block" id="h10_rmshe"><a class="viewcode-back" href="../../api/hydrostats.metrics.h10_rmshe.html#hydrostats.metrics.h10_rmshe">[docs]</a><span class="k">def</span> <span class="nf">h10_rmshe</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
              <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;H10 Metric: Methods from Tornqvist L, Vartia P, and Vartia YO. (1985).&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">h</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">mean</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">sqrt</span><span class="p">((</span><span class="n">h</span> <span class="o">**</span> <span class="mi">2</span><span class="p">)))</span></div>


<span class="c1">###################################################################################################</span>
<span class="c1">#                         Statistical Error Metrics for Distribution Testing                      #</span>
<span class="c1">###################################################################################################</span>


<div class="viewcode-block" id="g_mean_diff"><a class="viewcode-back" href="../../api/hydrostats.metrics.g_mean_diff.html#hydrostats.metrics.g_mean_diff">[docs]</a><span class="k">def</span> <span class="nf">g_mean_diff</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Returns the geometric mean difference.&quot;&quot;&quot;</span>

    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="n">sim_log</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
    <span class="n">obs_log</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">exp</span><span class="p">(</span><span class="n">gmean</span><span class="p">(</span><span class="n">sim_log</span><span class="p">)</span> <span class="o">-</span> <span class="n">gmean</span><span class="p">(</span><span class="n">obs_log</span><span class="p">))</span></div>


<div class="viewcode-block" id="mean_var"><a class="viewcode-back" href="../../api/hydrostats.metrics.mean_var.html#hydrostats.metrics.mean_var">[docs]</a><span class="k">def</span> <span class="nf">mean_var</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
             <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">simulated_array</span><span class="p">,</span>
        <span class="n">observed_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="k">return</span> <span class="n">np</span><span class="o">.</span><span class="n">var</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span> <span class="o">-</span> <span class="n">np</span><span class="o">.</span><span class="n">log1p</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">))</span></div>


<span class="c1">####################################################################################################</span>
<span class="c1">#                                      HELPER FUNCTIONS                                            #</span>
<span class="c1">####################################################################################################</span>


<span class="k">class</span> <span class="nc">HydrostatsError</span><span class="p">(</span><span class="ne">Exception</span><span class="p">):</span>
    <span class="k">pass</span>


<span class="n">metric_names</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;Mean Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean Absolute Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean Squared Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Eclidean Distance&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Normalized Eclidean Distance&#39;</span><span class="p">,</span> <span class="s1">&#39;Root Mean Square Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Root Mean Squared Log Error&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Mean Absolute Scaled Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Coefficient of Determination&#39;</span><span class="p">,</span> <span class="s1">&#39;Anomaly Correlation Coefficient&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Mean Absolute Percentage Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean Absolute Percentage Deviation&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Symmetric Mean Absolute Percentage Error (1)&#39;</span><span class="p">,</span> <span class="s1">&#39;Symmetric Mean Absolute Percentage Error (2)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Index of Agreement (d)&#39;</span><span class="p">,</span> <span class="s1">&#39;Index of Agreement (d1)&#39;</span><span class="p">,</span> <span class="s1">&#39;Index of Agreement Refined (dr)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Relative Index of Agreement&#39;</span><span class="p">,</span> <span class="s1">&#39;Modified Index of Agreement&#39;</span><span class="p">,</span> <span class="s2">&quot;Watterson&#39;s M&quot;</span><span class="p">,</span> <span class="s1">&#39;Mielke-Berry R&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Nash-Sutcliffe Efficiency&#39;</span><span class="p">,</span> <span class="s1">&#39;Modified Nash-Sutcliffe Efficiency&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Relative Nash-Sutcliffe Efficiency&#39;</span><span class="p">,</span> <span class="s1">&#39;Legate-McCabe Efficiency Index&#39;</span><span class="p">,</span> <span class="s1">&#39;Spectral Angle&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Spectral Correlation&#39;</span><span class="p">,</span> <span class="s1">&#39;Spectral Information Divergence&#39;</span><span class="p">,</span> <span class="s1">&#39;Spectral Gradient Angle&#39;</span><span class="p">,</span>
    <span class="s1">&#39;H1 - MHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H1 - AHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H1 - RMSHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H2 - MHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H2 - AHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H2 - RMSHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H3 - MHE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;H3 - AHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H3 - RMSHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H4 - MHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H4 - AHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H4 - RMSHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H5 - MHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H5 - AHE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;H5 - RMSHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H6 - MHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H6 - AHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H6 - RMSHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H7 - MHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H7 - AHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H7 - RMSHE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;H8 - MHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H8 - AHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H8 - RMSHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H10 - MHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H10 - AHE&#39;</span><span class="p">,</span> <span class="s1">&#39;H10 - RMSHE&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Geometric Mean Difference&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean Variance&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean Log Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Mean Absolute Log Error&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Mean Squared Log Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Normalized Root Mean Square Error - Range&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Normalized Root Mean Square Error - Mean&#39;</span><span class="p">,</span> <span class="s1">&#39;Normalized Root Mean Square Error - IQR&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Mean Arctangent Absolute Percentage Error&#39;</span><span class="p">,</span> <span class="s1">&#39;Legate-McCabe Index of Agreement&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Volumetric Efficiency&#39;</span><span class="p">,</span> <span class="s1">&#39;Pearson R&#39;</span><span class="p">,</span> <span class="s1">&#39;Spearman R&#39;</span><span class="p">,</span> <span class="s1">&#39;Kling-Gupta Efficiency (2009)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;Kling-Gupta Efficiency (2012)&#39;</span>
<span class="p">]</span>

<span class="n">metric_abbr</span> <span class="o">=</span> <span class="p">[</span>
    <span class="s1">&#39;ME&#39;</span><span class="p">,</span> <span class="s1">&#39;MAE&#39;</span><span class="p">,</span> <span class="s1">&#39;MSE&#39;</span><span class="p">,</span> <span class="s1">&#39;ED&#39;</span><span class="p">,</span> <span class="s1">&#39;NED&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSE&#39;</span><span class="p">,</span> <span class="s1">&#39;RMSLE&#39;</span><span class="p">,</span> <span class="s1">&#39;MASE&#39;</span><span class="p">,</span> <span class="s1">&#39;r2&#39;</span><span class="p">,</span> <span class="s1">&#39;ACC&#39;</span><span class="p">,</span> <span class="s1">&#39;MAPE&#39;</span><span class="p">,</span> <span class="s1">&#39;MAPD&#39;</span><span class="p">,</span> <span class="s1">&#39;SMAPE1&#39;</span><span class="p">,</span>
    <span class="s1">&#39;SMAPE2&#39;</span><span class="p">,</span> <span class="s1">&#39;d&#39;</span><span class="p">,</span> <span class="s1">&#39;d1&#39;</span><span class="p">,</span> <span class="s1">&#39;dr&#39;</span><span class="p">,</span> <span class="s1">&#39;d (Rel.)&#39;</span><span class="p">,</span> <span class="s1">&#39;d (Mod.)&#39;</span><span class="p">,</span> <span class="s1">&#39;M&#39;</span><span class="p">,</span> <span class="s1">&#39;(MB) R&#39;</span><span class="p">,</span> <span class="s1">&#39;NSE&#39;</span><span class="p">,</span> <span class="s1">&#39;NSE (Mod.)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NSE (Rel.)&#39;</span><span class="p">,</span> <span class="s2">&quot;E1&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;SA&#39;</span><span class="p">,</span> <span class="s1">&#39;SC&#39;</span><span class="p">,</span> <span class="s1">&#39;SID&#39;</span><span class="p">,</span> <span class="s1">&#39;SGA&#39;</span><span class="p">,</span> <span class="s1">&#39;H1 (MHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H1 (AHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H1 (RMSHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H2 (MHE)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;H2 (AHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H2 (RMSHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H3 (MHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H3 (AHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H3 (RMSHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H4 (MHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H4 (AHE)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;H4 (RMSHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H5 (MHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H5 (AHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H5 (RMSHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H6 (MHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H6 (AHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H6 (RMSHE)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;H7 (MHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H7 (AHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H7 (RMSHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H8 (MHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H8 (AHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H8 (RMSHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H10 (MHE)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;H10 (AHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;H10 (RMSHE)&#39;</span><span class="p">,</span> <span class="s1">&#39;GMD&#39;</span><span class="p">,</span> <span class="s1">&#39;MV&#39;</span><span class="p">,</span> <span class="s1">&#39;MLE&#39;</span><span class="p">,</span> <span class="s1">&#39;MALE&#39;</span><span class="p">,</span> <span class="s1">&#39;MSLE&#39;</span><span class="p">,</span> <span class="s1">&#39;NRMSE (Range)&#39;</span><span class="p">,</span> <span class="s1">&#39;NRMSE (Mean)&#39;</span><span class="p">,</span>
    <span class="s1">&#39;NRMSE (IQR)&#39;</span><span class="p">,</span> <span class="s1">&#39;MAAPE&#39;</span><span class="p">,</span> <span class="s2">&quot;D1&#39;&quot;</span><span class="p">,</span> <span class="s1">&#39;VE&#39;</span><span class="p">,</span> <span class="s1">&#39;R (Pearson)&#39;</span><span class="p">,</span> <span class="s1">&#39;R (Spearman)&#39;</span><span class="p">,</span> <span class="s1">&#39;KGE (2009)&#39;</span><span class="p">,</span> <span class="s1">&#39;KGE (2012)&#39;</span>
<span class="p">]</span>

<span class="n">function_list</span> <span class="o">=</span> <span class="p">[</span>
    <span class="n">me</span><span class="p">,</span> <span class="n">mae</span><span class="p">,</span> <span class="n">mse</span><span class="p">,</span> <span class="n">ed</span><span class="p">,</span> <span class="n">ned</span><span class="p">,</span> <span class="n">rmse</span><span class="p">,</span> <span class="n">rmsle</span><span class="p">,</span> <span class="n">mase</span><span class="p">,</span> <span class="n">r_squared</span><span class="p">,</span> <span class="n">acc</span><span class="p">,</span> <span class="n">mape</span><span class="p">,</span> <span class="n">mapd</span><span class="p">,</span> <span class="n">smape1</span><span class="p">,</span> <span class="n">smape2</span><span class="p">,</span> <span class="n">d</span><span class="p">,</span> <span class="n">d1</span><span class="p">,</span> <span class="n">dr</span><span class="p">,</span>
    <span class="n">drel</span><span class="p">,</span> <span class="n">dmod</span><span class="p">,</span> <span class="n">watt_m</span><span class="p">,</span> <span class="n">mb_r</span><span class="p">,</span> <span class="n">nse</span><span class="p">,</span> <span class="n">nse_mod</span><span class="p">,</span> <span class="n">nse_rel</span><span class="p">,</span> <span class="n">lm_index</span><span class="p">,</span> <span class="n">sa</span><span class="p">,</span> <span class="n">sc</span><span class="p">,</span> <span class="n">sid</span><span class="p">,</span> <span class="n">sga</span><span class="p">,</span> <span class="n">h1_mhe</span><span class="p">,</span> <span class="n">h1_ahe</span><span class="p">,</span>
    <span class="n">h1_rmshe</span><span class="p">,</span> <span class="n">h2_mhe</span><span class="p">,</span> <span class="n">h2_ahe</span><span class="p">,</span> <span class="n">h2_rmshe</span><span class="p">,</span> <span class="n">h3_mhe</span><span class="p">,</span> <span class="n">h3_ahe</span><span class="p">,</span> <span class="n">h3_rmshe</span><span class="p">,</span> <span class="n">h4_mhe</span><span class="p">,</span> <span class="n">h4_ahe</span><span class="p">,</span> <span class="n">h4_rmshe</span><span class="p">,</span> <span class="n">h5_mhe</span><span class="p">,</span>
    <span class="n">h5_ahe</span><span class="p">,</span> <span class="n">h5_rmshe</span><span class="p">,</span> <span class="n">h6_mhe</span><span class="p">,</span> <span class="n">h6_ahe</span><span class="p">,</span> <span class="n">h6_rmshe</span><span class="p">,</span> <span class="n">h7_mhe</span><span class="p">,</span> <span class="n">h7_ahe</span><span class="p">,</span> <span class="n">h7_rmshe</span><span class="p">,</span> <span class="n">h8_mhe</span><span class="p">,</span> <span class="n">h8_ahe</span><span class="p">,</span> <span class="n">h8_rmshe</span><span class="p">,</span>
    <span class="n">h10_mhe</span><span class="p">,</span> <span class="n">h10_ahe</span><span class="p">,</span> <span class="n">h10_rmshe</span><span class="p">,</span> <span class="n">g_mean_diff</span><span class="p">,</span> <span class="n">mean_var</span><span class="p">,</span> <span class="n">mle</span><span class="p">,</span> <span class="n">male</span><span class="p">,</span> <span class="n">msle</span><span class="p">,</span> <span class="n">nrmse_range</span><span class="p">,</span> <span class="n">nrmse_mean</span><span class="p">,</span>
    <span class="n">nrmse_iqr</span><span class="p">,</span> <span class="n">maape</span><span class="p">,</span> <span class="n">d1_p</span><span class="p">,</span> <span class="n">ve</span><span class="p">,</span> <span class="n">pearson_r</span><span class="p">,</span> <span class="n">spearman_r</span><span class="p">,</span> <span class="n">kge_2009</span><span class="p">,</span> <span class="n">kge_2012</span>
<span class="p">]</span>


<span class="k">def</span> <span class="nf">remove_values</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                  <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span>
                  <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Removes the nan, negative, and inf values in two numpy arrays&quot;&quot;&quot;</span>
    <span class="c1"># Filtering warnings so that user doesn&#39;t see them while we remove the nans</span>
    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;ignore&quot;</span><span class="p">)</span>
    <span class="c1"># Checking to see if the vectors are the same length</span>
    <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">simulated_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span> <span class="ow">or</span> <span class="nb">len</span><span class="p">(</span><span class="n">observed_array</span><span class="o">.</span><span class="n">shape</span><span class="p">)</span> <span class="o">!=</span> <span class="mi">1</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;One or both of the ndarrays are not 1 dimensional.&quot;</span><span class="p">)</span>
    <span class="k">if</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span> <span class="o">!=</span> <span class="n">observed_array</span><span class="o">.</span><span class="n">size</span><span class="p">:</span>
        <span class="k">raise</span> <span class="n">HydrostatsError</span><span class="p">(</span><span class="s2">&quot;The two ndarrays are not the same size.&quot;</span><span class="p">)</span>
    <span class="c1"># Finding the original length of the two arrays</span>
    <span class="n">original_length</span> <span class="o">=</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span>
    <span class="k">if</span> <span class="n">replace_nan</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Finding the NaNs</span>
        <span class="n">sim_nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
        <span class="n">obs_nan</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
        <span class="c1"># Replacing the NaNs with the input</span>
        <span class="n">simulated_array</span><span class="p">[</span><span class="n">sim_nan</span><span class="p">]</span> <span class="o">=</span> <span class="n">replace_nan</span>
        <span class="n">observed_array</span><span class="p">[</span><span class="n">obs_nan</span><span class="p">]</span> <span class="o">=</span> <span class="n">replace_nan</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Finding the nan values and combining them</span>
        <span class="n">sim_nan</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
        <span class="n">obs_nan</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isnan</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
        <span class="n">nan_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">sim_nan</span><span class="p">,</span> <span class="n">obs_nan</span><span class="p">)</span>
        <span class="n">simulated_array</span> <span class="o">=</span> <span class="n">simulated_array</span><span class="p">[</span><span class="n">nan_indices</span><span class="p">]</span>
        <span class="n">observed_array</span> <span class="o">=</span> <span class="n">observed_array</span><span class="p">[</span><span class="n">nan_indices</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">replace_inf</span> <span class="ow">is</span> <span class="ow">not</span> <span class="kc">None</span><span class="p">:</span>
        <span class="c1"># Finding the NaNs</span>
        <span class="n">sim_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
        <span class="n">obs_inf</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
        <span class="c1"># Replacing the NaNs with the input</span>
        <span class="n">simulated_array</span><span class="p">[</span><span class="n">sim_inf</span><span class="p">]</span> <span class="o">=</span> <span class="n">replace_inf</span>
        <span class="n">observed_array</span><span class="p">[</span><span class="n">obs_inf</span><span class="p">]</span> <span class="o">=</span> <span class="n">replace_inf</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="c1"># Getting the indices of the nan values, combining them, and removing them from both arrays</span>
        <span class="n">sim_inf</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">simulated_array</span><span class="p">)</span>
        <span class="n">obs_inf</span> <span class="o">=</span> <span class="o">~</span><span class="n">np</span><span class="o">.</span><span class="n">isinf</span><span class="p">(</span><span class="n">observed_array</span><span class="p">)</span>
        <span class="n">inf_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">sim_inf</span><span class="p">,</span> <span class="n">obs_inf</span><span class="p">)</span>
        <span class="n">simulated_array</span> <span class="o">=</span> <span class="n">simulated_array</span><span class="p">[</span><span class="n">inf_indices</span><span class="p">]</span>
        <span class="n">observed_array</span> <span class="o">=</span> <span class="n">observed_array</span><span class="p">[</span><span class="n">inf_indices</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">remove_neg</span><span class="p">:</span>
        <span class="c1"># Finding the negative indices and combining them</span>
        <span class="n">sim_neg</span> <span class="o">=</span> <span class="n">simulated_array</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="n">obs_neg</span> <span class="o">=</span> <span class="n">observed_array</span> <span class="o">&gt;=</span> <span class="mi">0</span>
        <span class="n">neg_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">sim_neg</span><span class="p">,</span> <span class="n">obs_neg</span><span class="p">)</span>
        <span class="c1"># Removing the negative indices</span>
        <span class="n">simulated_array</span> <span class="o">=</span> <span class="n">simulated_array</span><span class="p">[</span><span class="n">neg_indices</span><span class="p">]</span>
        <span class="n">observed_array</span> <span class="o">=</span> <span class="n">observed_array</span><span class="p">[</span><span class="n">neg_indices</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">remove_zero</span><span class="p">:</span>
        <span class="c1"># Finding the zero indices and combining them</span>
        <span class="n">sim_zero</span> <span class="o">=</span> <span class="n">simulated_array</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="n">obs_zero</span> <span class="o">=</span> <span class="n">observed_array</span> <span class="o">!=</span> <span class="mi">0</span>
        <span class="n">zero_indices</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">logical_and</span><span class="p">(</span><span class="n">sim_zero</span><span class="p">,</span> <span class="n">obs_zero</span><span class="p">)</span>
        <span class="c1"># Removing the zero indices</span>
        <span class="n">simulated_array</span> <span class="o">=</span> <span class="n">simulated_array</span><span class="p">[</span><span class="n">zero_indices</span><span class="p">]</span>
        <span class="n">observed_array</span> <span class="o">=</span> <span class="n">observed_array</span><span class="p">[</span><span class="n">zero_indices</span><span class="p">]</span>

    <span class="c1"># Finding the final length of the arrays</span>
    <span class="n">final_length</span> <span class="o">=</span> <span class="n">simulated_array</span><span class="o">.</span><span class="n">size</span>

    <span class="n">warnings</span><span class="o">.</span><span class="n">filterwarnings</span><span class="p">(</span><span class="s2">&quot;always&quot;</span><span class="p">)</span>
    <span class="c1"># Checking to see if any of the values were removed</span>
    <span class="k">if</span> <span class="n">final_length</span> <span class="o">!=</span> <span class="n">original_length</span><span class="p">:</span>
        <span class="n">warnings</span><span class="o">.</span><span class="n">warn</span><span class="p">(</span>
            <span class="s2">&quot;One of the arrays contained negative, nan, or inf values and they have been removed.&quot;</span><span class="p">,</span>
            <span class="ne">Warning</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">simulated_array</span><span class="p">,</span> <span class="n">observed_array</span>


<span class="k">def</span> <span class="nf">list_of_metrics</span><span class="p">(</span><span class="n">metrics</span><span class="p">,</span> <span class="n">sim_array</span><span class="p">,</span> <span class="n">obs_array</span><span class="p">,</span> <span class="n">abbr</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">mase_m</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">dmod_j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">nse_mod_j</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">h6_mhe_k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">h6_ahe_k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span>
                    <span class="n">h6_rmshe_k</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">d1_p_obs_bar_p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">lm_x_obs_bar_p</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span> <span class="n">replace_nan</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">replace_inf</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
                    <span class="n">remove_neg</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">remove_zero</span><span class="o">=</span><span class="kc">False</span><span class="p">):</span>

    <span class="c1"># Removing values or replacing them based on user input and checking the length of the values</span>
    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">sim_array</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">obs_array</span><span class="p">)</span>
    <span class="n">sim_array</span><span class="p">,</span> <span class="n">obs_array</span> <span class="o">=</span> <span class="n">remove_values</span><span class="p">(</span>
        <span class="n">sim_array</span><span class="p">,</span>
        <span class="n">obs_array</span><span class="p">,</span>
        <span class="n">replace_nan</span><span class="o">=</span><span class="n">replace_nan</span><span class="p">,</span>
        <span class="n">replace_inf</span><span class="o">=</span><span class="n">replace_inf</span><span class="p">,</span>
        <span class="n">remove_neg</span><span class="o">=</span><span class="n">remove_neg</span><span class="p">,</span>
        <span class="n">remove_zero</span><span class="o">=</span><span class="n">remove_zero</span>
    <span class="p">)</span>

    <span class="c1"># Empty list for the metrics that are returned</span>
    <span class="n">metrics_list</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="c1"># creating a list of indices for the selected metrics</span>
    <span class="n">metrics_indices</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="ow">not</span> <span class="n">abbr</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
            <span class="n">metrics_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metric_names</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics</span><span class="p">:</span>
            <span class="n">metrics_indices</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">metric_abbr</span><span class="o">.</span><span class="n">index</span><span class="p">(</span><span class="n">i</span><span class="p">))</span>

    <span class="c1"># Creating a list of selected metric functions</span>
    <span class="n">selected_metrics</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">metrics_indices</span><span class="p">:</span>
        <span class="n">selected_metrics</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">function_list</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>

    <span class="k">for</span> <span class="n">index</span><span class="p">,</span> <span class="n">func</span> <span class="ow">in</span> <span class="nb">zip</span><span class="p">(</span><span class="n">metrics_indices</span><span class="p">,</span> <span class="n">selected_metrics</span><span class="p">):</span>
        <span class="k">if</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">7</span><span class="p">:</span>
            <span class="n">metrics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">sim_array</span><span class="p">,</span> <span class="n">obs_array</span><span class="p">,</span> <span class="n">m</span><span class="o">=</span><span class="n">mase_m</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">18</span><span class="p">:</span>
            <span class="n">metrics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">sim_array</span><span class="p">,</span> <span class="n">obs_array</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="n">dmod_j</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">22</span><span class="p">:</span>
            <span class="n">metrics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">sim_array</span><span class="p">,</span> <span class="n">obs_array</span><span class="p">,</span> <span class="n">j</span><span class="o">=</span><span class="n">nse_mod_j</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">24</span><span class="p">:</span>
            <span class="n">metrics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">sim_array</span><span class="p">,</span> <span class="n">obs_array</span><span class="p">,</span> <span class="n">obs_bar_p</span><span class="o">=</span><span class="n">lm_x_obs_bar_p</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">44</span><span class="p">:</span>
            <span class="n">metrics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">sim_array</span><span class="p">,</span> <span class="n">obs_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">h6_mhe_k</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">45</span><span class="p">:</span>
            <span class="n">metrics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">sim_array</span><span class="p">,</span> <span class="n">obs_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">h6_ahe_k</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">46</span><span class="p">:</span>
            <span class="n">metrics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">sim_array</span><span class="p">,</span> <span class="n">obs_array</span><span class="p">,</span> <span class="n">k</span><span class="o">=</span><span class="n">h6_rmshe_k</span><span class="p">))</span>

        <span class="k">elif</span> <span class="n">index</span> <span class="o">==</span> <span class="mi">65</span><span class="p">:</span>
            <span class="n">metrics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">sim_array</span><span class="p">,</span> <span class="n">obs_array</span><span class="p">,</span> <span class="n">obs_bar_p</span><span class="o">=</span><span class="n">d1_p_obs_bar_p</span><span class="p">))</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="n">metrics_list</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">func</span><span class="p">(</span><span class="n">sim_array</span><span class="p">,</span> <span class="n">obs_array</span><span class="p">))</span>

    <span class="k">return</span> <span class="n">metrics_list</span>


<span class="k">if</span> <span class="vm">__name__</span> <span class="o">==</span> <span class="s2">&quot;__main__&quot;</span><span class="p">:</span>
    <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>

    <span class="c1"># long_str = &#39;&#39;</span>
    <span class="c1"># for i in __all__:</span>
    <span class="c1">#     long_str += i + &#39;, &#39;</span>
    <span class="c1"># print(long_str)</span>
    <span class="n">x</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">/</span> <span class="mi">20</span>

    <span class="n">sim</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">sin</span><span class="p">(</span><span class="n">x</span><span class="p">)</span> <span class="o">+</span> <span class="mi">2</span>
    <span class="n">obs</span> <span class="o">=</span> <span class="n">sim</span> <span class="o">*</span> <span class="p">(((</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">100</span><span class="p">)</span> <span class="o">-</span> <span class="mf">0.5</span><span class="p">)</span> <span class="o">/</span> <span class="mi">10</span><span class="p">)</span> <span class="o">+</span> <span class="mi">1</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">sim</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">plot</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="n">obs</span><span class="p">)</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>

    <span class="nb">print</span><span class="p">(</span><span class="n">me</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">obs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">irmse</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">obs</span><span class="p">))</span>
    <span class="nb">print</span><span class="p">(</span><span class="n">rmse</span><span class="p">(</span><span class="n">sim</span><span class="p">,</span> <span class="n">obs</span><span class="p">))</span>
</pre></div>

          </div>
        </div>
      </div>
      <div class="sphinxsidebar" role="navigation" aria-label="main navigation">
        <div class="sphinxsidebarwrapper">
<div id="searchbox" style="display: none" role="search">
  <h3>Quick search</h3>
    <div class="searchformwrapper">
    <form class="search" action="../../search.html" method="get">
      <input type="text" name="q" />
      <input type="submit" value="Go" />
      <input type="hidden" name="check_keywords" value="yes" />
      <input type="hidden" name="area" value="default" />
    </form>
    </div>
</div>
<script type="text/javascript">$('#searchbox').show(0);</script>
        </div>
      </div>
      <div class="clearer"></div>
    </div>
    <div class="related" role="navigation" aria-label="related navigation">
      <h3>Navigation</h3>
      <ul>
        <li class="right" style="margin-right: 10px">
          <a href="../../genindex.html" title="General Index"
             >index</a></li>
        <li class="right" >
          <a href="../../py-modindex.html" title="Python Module Index"
             >modules</a> |</li>
        <li class="nav-item nav-item-0"><a href="../../index.html">hydrostats 0.65 documentation</a> &#187;</li>
          <li class="nav-item nav-item-1"><a href="../index.html" >Module code</a> &#187;</li> 
      </ul>
    </div>
    <div class="footer" role="contentinfo">
        &#169; Copyright 2018, Wade Roberts.
      Created using <a href="http://sphinx-doc.org/">Sphinx</a> 1.7.6.
    </div>
  </body>
</html>